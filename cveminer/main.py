import argparse
from . import miner


def main():
    arg_parser = argparse.ArgumentParser(description='Mine a repository for CVEs and create a report based on the findings')
    group = arg_parser.add_mutually_exclusive_group(required=True)
    group.add_argument('-o', '--online', metavar='', help='Download and mine a repository from an online git repo')
    group.add_argument('-l', '--local', metavar='', help='Mine a local git repo')
    group.add_argument('-d', '--download', action='store_true', help='Download CVEs and insert them into csv files')
    group.add_argument('-db', '--database', action='store_true', help='Create database and store CVEs')
    group.add_argument('-j', '--json', metavar='', help='Mine every repo from a GHtorrent json data dump')
    args = arg_parser.parse_args()
    # this is just a placeholder so I can see that the arguments work
    if args.download or args.database:
        miner.manage_cves(args)
    elif args.online or args.local:
        miner.get_stats(args)
    else:
        miner.parse_ghtorrent_json(args)


if __name__ == '__main__':
    main()
